{"version":3,"file":"api.bundle.js","sources":["../src/index.js"],"sourcesContent":["import { ajax, Text } from 'main.core';\nimport { UI } from 'ui.notification';\n\nconst postHeaders = {\n\tpreparePost: false,\n\theaders: [{\n\t\tname: 'Content-Type',\n\t\tvalue: 'application/json'\n\t}]\n};\n\nexport class Api\n{\n\t#get(endpoint: string): Promise\n\t{\n\t\treturn this.#request('GET', endpoint);\n\t}\n\n\n\t#post(endpoint: string, data: Object = null, notifyError: boolean): Promise\n\t{\n\t\treturn this.#request('POST', endpoint, data, notifyError);\n\t}\n\n\tasync #request(\n\t\tmethod: string,\n\t\tendpoint: string,\n\t\tdata: ?Object,\n\t\tnotifyError: ?boolean = true\n\t)\n\t{\n\t\tconst config = { method };\n\t\tif (method === 'POST')\n\t\t{\n\t\t\tObject.assign(config, { data }, {\n\t\t\t\tpreparePost: false,\n\t\t\t\theaders: [{\n\t\t\t\t\tname: 'Content-Type',\n\t\t\t\t\tvalue: 'application/json'\n\t\t\t\t}]\n\t\t\t});\n\t\t}\n\n\t\ttry\n\t\t{\n\t\t\tconst response = await ajax.runAction(endpoint, config);\n\t\t\tif (response.errors?.length > 0)\n\t\t\t{\n\t\t\t\tthrow new Error(response.errors[0].message);\n\t\t\t}\n\n\t\t\treturn response.data;\n\t\t}\n\t\tcatch(ex)\n\t\t{\n\t\t\tif (!notifyError)\n\t\t\t{\n\t\t\t\treturn ex;\n\t\t\t}\n\n\t\t\tconst { errors = [], message = `Error in ${endpoint}` } = ex;\n\t\t\tconst content = ex.errors[0]?.message ?? message;\n\t\t\tUI.Notification.Center.notify({\n\t\t\t\tcontent: Text.encode(content),\n\t\t\t\tautoHideDelay: 4000\n\t\t\t});\n\n\t\t\tthrow ex;\n\t\t}\n\t}\n\n\tregister(blankId: string): Promise\n\t{\n\t\treturn this.#post('sign.api_v1.document.register', { blankId });\n\t}\n\n\tupload(uid: string): Promise\n\t{\n\t\treturn this.#post('sign.api_v1.document.upload', { uid });\n\t}\n\n\tgetPages(uid: string): Promise\n\t{\n\t\treturn this.#post('sign.api_v1.document.pages.list', { uid }, false);\n\t}\n\n\tloadBlanks(page: number): Promise\n\t{\n\t\treturn this.#post('sign.api_v1.document.blank.list', { page });\n\t}\n\n\tcreateBlank(files: Array<string>): Promise\n\t{\n\t\treturn this.#post('sign.api_v1.document.blank.create', { files });\n\t}\n\n\tsaveBlank(documentUid: string, blocks: []): Promise\n\t{\n\t\treturn this.#post('sign.api_v1.document.blank.block.save', { documentUid, blocks }, false);\n\t}\n\n\tloadBlocksData(documentUid: string, blocks: []): Promise\n\t{\n\t\treturn this.#post('sign.api_v1.document.blank.block.loadData', { documentUid, blocks });\n\t}\n\n\tchangeDocument(uid: string, blankId: number): Promise\n\t{\n\t\treturn this.#post('sign.api_v1.document.changeBlank', { uid, blankId });\n\t}\n\n\tloadDocument(uid: string): Promise\n\t{\n\t\treturn this.#post('sign.api_v1.document.load', { uid });\n\t}\n\n\tconfigureDocument(uid: string): Promise\n\t{\n\t\treturn this.#post('sign.api_v1.document.configure', { uid });\n\t}\n\n\tloadBlocksByDocument(documentUid: string): Promise\n\t{\n\t\treturn this.#post('sign.api_v1.document.blank.block.loadByDocument', {\n\t\t\tdocumentUid\n\t\t});\n\t}\n\n\tstartSigning(uid: string): Promise\n\t{\n\t\treturn this.#post('sign.api_v1.document.signing.start', { uid });\n\t}\n\n\taddMember(\n\t\tdocumentUid: string,\n\t\tentityType: string,\n\t\tentityId: number,\n\t\tparty: number,\n\t\tpresetId: number\n\t): Promise\n\t{\n\t\treturn this.#post('sign.api_v1.document.member.add', {\n\t\t\tdocumentUid,\n\t\t\tentityType,\n\t\t\tentityId,\n\t\t\tparty,\n\t\t\tpresetId\n\t\t});\n\t}\n\n\tremoveMember(uid: string): Promise\n\t{\n\t\treturn this.#post('sign.api_v1.document.member.remove', { uid });\n\t}\n\n\tloadMembers(documentUid: string): Promise\n\t{\n\t\treturn this.#post('sign.api_v1.document.member.load', { documentUid });\n\t}\n\n\tmodifyCommunicationChannel(uid: String, channelType: string, channelValue: string)\n\t{\n\t\treturn this.#post('sign.api_v1.document.member.modifyCommunicationChannel', {\n\t\t\tuid,\n\t\t\tchannelType,\n\t\t\tchannelValue\n\t\t});\n\t}\n\n\tloadCommunications(uid: String)\n\t{\n\t\treturn this.#post('sign.api_v1.document.member.loadCommunications', { uid });\n\t}\n\n\tmodifyTitle(uid: string, title: string): Promise\n\t{\n\t\treturn this.#post('sign.api_v1.document.modifyTitle', {\n\t\t\tuid,\n\t\t\ttitle\n\t\t});\n\t}\n\n\tmodifyInitiator(uid: string, initiator: string): Promise\n\t{\n\t\treturn this.#post('sign.api_v1.document.modifyInitiator', {\n\t\t\tuid,\n\t\t\tinitiator\n\t\t});\n\t}\n\n\trefreshEntityNumber(documentUid: string): Promise\n\t{\n\t\treturn this.#post('sign.api_v1.document.refreshEntityNumber', {\n\t\t\tdocumentUid,\n\t\t});\n\t}\n\n\tloadRestrictions(): Promise\n\t{\n\t\treturn this.#post('sign.api_v1.portal.hasRestrictions');\n\t}\n\n\tsaveStamp(memberUid: String, fileId: string): Promise\n\t{\n\t\treturn this.#post('sign.api_v1.document.member.saveStamp', {\n\t\t\tmemberUid, fileId\n\t\t});\n\t}\n}"],"names":["Api","register","blankId","upload","uid","getPages","loadBlanks","page","createBlank","files","saveBlank","documentUid","blocks","loadBlocksData","changeDocument","loadDocument","configureDocument","loadBlocksByDocument","startSigning","addMember","entityType","entityId","party","presetId","removeMember","loadMembers","modifyCommunicationChannel","channelType","channelValue","loadCommunications","modifyTitle","title","modifyInitiator","initiator","refreshEntityNumber","loadRestrictions","saveStamp","memberUid","fileId","endpoint","data","notifyError","method","config","Object","assign","preparePost","headers","name","value","response","ajax","runAction","errors","length","Error","message","ex","content","UI","Notification","Center","notify","Text","encode","autoHideDelay"],"mappings":"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"}