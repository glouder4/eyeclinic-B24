{"version":3,"file":"preview.bundle.js","sources":["../src/index.js"],"sourcesContent":["import { Tag, Loc, Dom, Text, Event } from 'main.core';\nimport { Loader } from 'main.loader';\nimport './style.css';\n\nconst ratio = 0.25;\n\nexport class Preview\n{\n\t#placeholder: HTMLElement;\n\t#page: HTMLElement;\n\t#pageNumber: number;\n\t#scale: number;\n\t#controls: HTMLElement;\n\t#blocksContainer: HTMLElement;\n\t#blocks: Map;\n\t#urls: string[];\n\t#loader: Loader;\n\n\tconstructor()\n\t{\n\t\tthis.#placeholder = Tag.render`\n\t\t\t<video\n\t\t\t\tposter=\"/bitrix/js/sign/preview/images/sign-preview-document-demo.jpg\"\n\t\t\t\tloop=\"true\"\n\t\t\t\tmuted=\"true\"\n\t\t\t\tplaysinline=\"true\"\n\t\t\t\tclass=\"sign-preview__placeholder\"\n\t\t\t>\n\t\t\t\t<source type=\"video/mp4\" src=\"/bitrix/js/sign/preview/images/sign-preview-document-demo.mp4\" />\n\t\t\t\t<source type=\"video/webm\" src=\"/bitrix/js/sign/preview/images/sign-preview-document-demo.webm\" />\n\t\t\t</video>\n\t\t`;\n\t\tthis.#page = Tag.render`<img class=\"sign-preview__page\" />`;\n\t\tthis.#blocksContainer = Tag.render`<div class=\"sign-preview__blocks\"></div>`;\n\t\tthis.#blocks = new Map();\n\t\tthis.#controls = this.#createControls();\n\t\tthis.#urls = [];\n\t\tthis.#pageNumber = 0;\n\t\tthis.#scale = 1;\n\t\tthis.#loader = new Loader();\n\t}\n\n\t#createBlockStyles(block)\n\t{\n\t\tconst { style, position, type } = block;\n\t\tconst { top, left, width, height, widthPx, heightPx } = position;\n\t\tconst inlineStyles = {\n\t\t\t...style,\n\t\t\ttop: `${position.top}%`,\n\t\t\tleft: `${position.left}%`,\n\t\t\twidth: `${width}%`,\n\t\t\theight: `${height}%`\n\t\t};\n\t\tif (type === 'image')\n\t\t{\n\t\t\treturn inlineStyles;\n\t\t}\n\n\t\tconst { width: pageWidth, height: pageHeight } = this.#page.getBoundingClientRect();\n\t\tconst widthRatio = widthPx / (width / 100 * pageWidth);\n\t\tconst heightRatio = heightPx / (height / 100 * pageHeight);\n\t\tconst fontSize = (parseFloat(style['fontSize']) || 14 ) / widthRatio;\n\t\tconst padding = `${5 / heightRatio}px ${8 / widthRatio}px`;\n\t\tObject.assign(inlineStyles, {\n\t\t\tpadding,\n\t\t\tfontSize: `${fontSize}px`\n\t\t});\n\n\t\treturn inlineStyles;\n\t}\n\n\tasync #createBlocks(blocksData)\n\t{\n\t\tconst isLoaded = this.#page.complete && this.#page.naturalHeight !== 0;\n\t\tif (!isLoaded)\n\t\t{\n\t\t\tawait new Promise((resolve) => Event.bindOnce(this.#page, 'load', resolve));\n\t\t}\n\n\t\tconst { blocksTemplate, blocks } = blocksData.reduce((acc, block) => {\n\t\t\tconst node = Tag.render`\n\t\t\t\t<div class=\"sign-preview__block\"></div>\n\t\t\t`;\n\t\t\tconst blockContent = this.#getBlockContent(block);\n\t\t\tif (blockContent)\n\t\t\t{\n\t\t\t\tDom.append(blockContent, node);\n\t\t\t\tDom.addClass(node, '--filled');\n\t\t\t}\n\n\t\t\tconst inlineStyles = this.#createBlockStyles(block);\n\t\t\tObject.keys(inlineStyles).forEach(styleName => {\n\t\t\t\tnode.style[styleName] = inlineStyles[styleName];\n\t\t\t});\n\t\t\tconst { blocks, blocksTemplate } = acc;\n\t\t\tconst { page } = block.position;\n\t\t\tblocks.set(page, [\n\t\t\t\t...(blocks.get(page) ?? []),\n\t\t\t\tnode\n\t\t\t]);\n\t\t\tDom.append(node, blocksTemplate);\n\n\t\t\treturn acc;\n\t\t}, {\n\t\t\tblocks: new Map(),\n\t\t\tblocksTemplate: new DocumentFragment()\n\t\t});\n\t\tDom.append(blocksTemplate, this.#blocksContainer);\n\n\t\treturn blocks;\n\t}\n\n\t#getBlockContent(block): HTMLElement | null\n\t{\n\t\tif (block.type === 'image')\n\t\t{\n\t\t\treturn this.#getImageLayout(block);\n\t\t}\n\n\t\treturn this.#getTextLayout(block);\n\t}\n\n\t#getImageLayout(block): HTMLElement | null\n\t{\n\t\tconst url = block.data.__view?.base64;\n\t\tif (!url)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst img = Tag.render`<img src=\"data:image;base64,${url}\" />`;\n\n\t\treturn img;\n\t}\n\n\t#getTextLayout(block): HTMLElement | null\n\t{\n\t\tlet text = block.data.text;\n\t\tif (!text)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\ttext = Text.encode(text);\n\n\t\tconst span = Tag.render`<span>${text}</span>`;\n\t\tspan.innerHTML = text.replaceAll('[br]', '<br />');\n\n\t\treturn span;\n\t}\n\n\t#createContent(): HTMLElement\n\t{\n\t\tconst content = Tag.render`\n\t\t\t<div class=\"sign-preview__content\">\n\t\t\t\t${this.#placeholder}\n\t\t\t\t${this.#page}\n\t\t\t\t${this.#blocksContainer}\n\t\t\t</div>\n\t\t`;\n\t\tthis.#loader.setOptions({ target: content, size: 80 });\n\n\t\treturn content;\n\t}\n\n\t#createControls(): HTMLElement\n\t{\n\t\tconst pagination = Tag.render`\n\t\t\t<div class=\"sign-preview__pagination\">\n\t\t\t\t<span\n\t\t\t\t\tclass=\"sign-preview__btn sign-preview__pagination_btn --prev\"\n\t\t\t\t\tonclick=\"${() => {\n\t\t\t\t\t\tthis.#pageNumber -= 1;\n\t\t\t\t\t\tthis.#render();\n\t\t\t\t\t}}\"\n\t\t\t\t>\n\t\t\t\t</span>\n\t\t\t\t<span class=\"sign-preview__pagination_page-num\"></span>\n\t\t\t\t<span\n\t\t\t\t\tclass=\"sign-preview__btn sign-preview__pagination_btn --next\"\n\t\t\t\t\tonclick=\"${() => {\n\t\t\t\t\t\tthis.#pageNumber += 1;\n\t\t\t\t\t\tthis.#render();\n\t\t\t\t\t}}\"\n\t\t\t\t>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t`;\n\t\tconst zoom = Tag.render`\n\t\t\t<div class=\"sign-preview__zoom\">\n\t\t\t\t<span\n\t\t\t\t\tclass=\"sign-preview__btn sign-preview__zoom_btn --plus\"\n\t\t\t\t\tonclick=\"${() => {\n\t\t\t\t\t\tthis.#scale -= ratio;\n\t\t\t\t\t\tthis.#renderContent();\n\t\t\t\t\t\tthis.#renderZoom();\n\t\t\t\t\t}}\"\n\t\t\t\t>\n\t\t\t\t</span>\n\t\t\t\t<span class=\"sign-preview__zoom_value\">100%</span>\n\t\t\t\t<span\n\t\t\t\t\tclass=\"sign-preview__btn sign-preview__zoom_btn --minus\"\n\t\t\t\t\tonclick=\"${() => {\n\t\t\t\t\t\tthis.#scale += ratio;\n\t\t\t\t\t\tthis.#renderContent();\n\t\t\t\t\t\tthis.#renderZoom();\n\t\t\t\t\t}}\"\n\t\t\t\t></span>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"sign-preview__controls\">\n\t\t\t\t${pagination}\n\t\t\t\t${zoom}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetLayout(): HTMLElement\n\t{\n\t\tconst layout = Tag.render`\n\t\t\t<div class=\"sign-preview\">\n\t\t\t\t${this.#createContent()}\n\t\t\t\t${this.#controls}\n\t\t\t</div>\n\t\t`;\n\t\tthis.#render();\n\n\t\treturn layout;\n\t}\n\n\t#render()\n\t{\n\t\tthis.#renderContent();\n\t\tthis.#renderBlocks();\n\t\tthis.#renderControls();\n\t}\n\n\t#renderContent()\n\t{\n\t\tDom.removeClass(this.#placeholder, '--hidden');\n\t\tDom.removeClass(this.#page, '--hidden');\n\t\tif (!this.#urls.length)\n\t\t{\n\t\t\tDom.addClass(this.#page, '--hidden');\n\t\t\tthis.#page.src = '';\n\t\t\tthis.#page.style.transform = '';\n\t\t\tthis.#placeholder.play();\n\t\t\treturn;\n\t\t}\n\n\t\tDom.addClass(this.#placeholder, '--hidden');\n\t\tconst url = this.#urls[this.#pageNumber];\n\t\tthis.#page.src = url;\n\t\tthis.#page.style.transform = `scale(${this.#scale})`;\n\t}\n\n\t#renderBlocks()\n\t{\n\t\tconst visibleBlocks = this.#blocks.get(this.#pageNumber + 1) ?? [];\n\t\tconst allBlocks = [...this.#blocks.values()].flat();\n\t\tallBlocks.forEach((block) => {\n\t\t\tif (visibleBlocks.includes(block))\n\t\t\t{\n\t\t\t\tDom.removeClass(block, '--hidden');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tDom.addClass(block, '--hidden');\n\t\t});\n\t}\n\n\t#renderControls()\n\t{\n\t\tif (!this.#urls.length)\n\t\t{\n\t\t\tDom.addClass(this.#controls, '--locked');\n\t\t\tthis.#pageNumber = 0;\n\t\t\tthis.#scale = 1;\n\t\t\treturn;\n\t\t}\n\n\t\tDom.removeClass(this.#controls, '--locked');\n\t\tthis.#renderPagination();\n\t\tthis.#renderZoom();\n\t}\n\n\t#renderPagination()\n\t{\n\t\tconst [pagination] = this.#controls.children;\n\t\tconst [prevBtn, content, nextBtn] = pagination.children;\n\t\tconst message = Loc.getMessage('SIGN_PREVIEW_PAGE');\n\t\tconst totalPages = this.#urls.length;\n\t\tDom.removeClass(prevBtn, '--disabled');\n\t\tDom.removeClass(nextBtn, '--disabled');\n\t\tcontent.textContent = `${message} ${this.#pageNumber + 1}/${totalPages}`;\n\t\tif (this.#pageNumber === 0)\n\t\t{\n\t\t\tDom.addClass(prevBtn, '--disabled');\n\t\t}\n\t\tif (this.#pageNumber === totalPages - 1)\n\t\t{\n\t\t\tDom.addClass(nextBtn, '--disabled');\n\t\t}\n\t}\n\n\t#renderZoom()\n\t{\n\t\tconst [,zoom] = this.#controls.children;\n\t\tconst [zoomOutBtn, content, zoomInBtn] = zoom.children;\n\t\tcontent.textContent = `${this.#scale * 100}%`;\n\t\tif (this.#scale !== 1)\n\t\t{\n\t\t\tDom.addClass(this.#page.parentElement, '--overflowed');\n\t\t\tDom.removeClass(zoomOutBtn, '--disabled');\n\t\t\tif (this.#scale === 2)\n\t\t\t{\n\t\t\t\tDom.addClass(zoomInBtn, '--disabled');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(zoomOutBtn, '--disabled');\n\t\t\tDom.removeClass(zoomInBtn, '--disabled');\n\t\t\tDom.removeClass(this.#page.parentElement, '--overflowed');\n\t\t}\n\t}\n\n\tset urls(urls: string[])\n\t{\n\t\tthis.#urls = urls;\n\t\tthis.#renderContent();\n\t\tthis.#renderControls();\n\t}\n\n\tset ready(isReady: boolean)\n\t{\n\t\tif (isReady)\n\t\t{\n\t\t\tthis.#loader.hide();\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#loader.show();\n\t}\n\n\tasync setBlocks(blocks)\n\t{\n\t\tDom.clean(this.#blocksContainer);\n\t\tif (!blocks?.length)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#blocks = await this.#createBlocks(blocks);\n\t\tthis.#renderBlocks();\n\t}\n}"],"names":["ratio","Preview","constructor","Tag","render","Map","Loader","getLayout","layout","urls","ready","isReady","hide","show","setBlocks","blocks","Dom","clean","length","block","style","position","type","top","left","width","height","widthPx","heightPx","inlineStyles","pageWidth","pageHeight","getBoundingClientRect","widthRatio","heightRatio","fontSize","parseFloat","padding","Object","assign","blocksData","isLoaded","complete","naturalHeight","Promise","resolve","Event","bindOnce","blocksTemplate","reduce","acc","node","blockContent","append","addClass","keys","forEach","styleName","page","set","get","DocumentFragment","url","data","__view","base64","img","text","Text","encode","span","innerHTML","replaceAll","content","setOptions","target","size","pagination","zoom","removeClass","src","transform","play","visibleBlocks","allBlocks","values","flat","includes","children","prevBtn","nextBtn","message","Loc","getMessage","totalPages","textContent","zoomOutBtn","zoomInBtn","parentElement"],"mappings":"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"}